#!/usr/bin/env bash

if [ ${OS_VERSION:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516,CVE-2024-47081
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6" \
                                       "requests==2.32.4" \
                                       "urllib3==1.26.20"
elif [ ${OS_VERSION:-master} = "stable/2024.1" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,CVE-2024-36039,CVE-2024-42353,GHSA-h4gh-qq45-vh27,
    #           CVE-2023-29483,CVE-2024-3651,CVE-2024-35195,CVE-2024-4340,CVE-2024-37891,CVE-2024-5569,CVE-2024-12797,CVE-2024-47081
    #           CVE-2025-58068
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6" \
                                       "PyMySQL>=1.1.1,<1.2" \
                                       "WebOb==1.8.8" \
                                       "cryptography==44.0.1" \
                                       "dnspython>=2.6.1,<2.7" \
                                       "eventlet>=0.35.2" \
                                       "idna>=3.7,<3.8" \
                                       "requests==2.32.4" \
                                       "sqlparse>=0.5.0,<0.6" \
                                       "urllib3==1.26.20" \
                                       "zipp>=3.19.1,<3.20"
fi
